<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<meta http-equiv="content-type" content="text/html;charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<link rel="shortcut icon" href="img/title.ico">
<title>File Browsing</title>
<!-- <link rel="shortcut icon" href="img/title.ico"> -->

<link rel="stylesheet" type="text/css" href="index/css/style.css">

<script type="text/javascript" src="index/js/jquery.min.js"></script>
<script type="text/javascript" src="index/js/vector.js"></script>

</head>
<body>

<div id="container">
	<div id="output">
		<div class="containerT">
			<h1>用户注册</h1>
			<form class="form" id="entry_form" action="/register" method="post" enctype="text/plain" validate>
				<input type="text" placeholder="请输入用户名" id="entry_name" value="" required>
				<input type="password" placeholder="请输入密码" id="entry_password" required>
                <input type="password" placeholder="再次输入密码" id="entry_password2" required>
				<button type="submit" id="entry_btn2">注册</button>
				<!-- <div id="prompt" class="prompt"></div> -->
			</form>
		</div>
	</div>
</div>

<script type="text/javascript">
    // $(function(){
    //     Victor("container", "output");   //登陆背景函数
    //     $("#entry_name").focus();
    //     $(document).keydown(function(event){
    //         if(event.keyCode==13){
    //             $("#entry_btn").click();
    //         }
    //     });
	// });
	
	$(function(){ 
        // $("#register0").click(function(){ 
        //     location.href = 'register';
		// });
		Victor("container", "output");   //登陆背景函数
        $("#entry_name").focus();
        $(document).keydown(function(event){
            if(event.keyCode==13){
                $("#entry_btn").click();
            }
        });
        $("#entry_btn").click(function(){ 
            var username = $("#entry_name").val();
            var password = $("#entry_password").val();
            var password2 = $("#entry_password2").val();

            console.log(password2)
            console.log(password)
            console.log(username)

            if (password.trim() == password2.trim()) {
                return
            }

            if (password2 != password2) {
                alert("两次输入密码不同！")
                // location.reload()
                return
            }

            var data = {"uname":username,"upwd":password, "upwd2":password2};
            $.ajax({ 
                url:'/register',
                type:'post',
                data: data,
                success: function(data,status){ 
                    if(data["status"] == 'success'){
                        alert("注册成功，跳转到登录页面！")
                        location.href = '/index.html';
                    } else {
                        alert("注册失败，请重试！")
                        // location.href = data["url"];
                        location.reload()
					}
                },
                error: function(data,status){ 
                    if(status == 'error'){ 
                        alert("注册失败，请重试！")
                        location.reload()
                    }
                }
            });
        });
    });
</script>

</body>
</html>
